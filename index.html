<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>جدول المهام - الجدول الأول والثاني</title>

    <!-- ملف Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- خط Tajawal من Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <!-- تنسيقات داخلية -->
    <style>
      html,
      body {
        height: 100%;
        width: 100%;
        font-family: "Tajawal", sans-serif;
        background-color: #f0f4f8;
        direction: rtl;
        margin: 0;
        padding: 0;
      }

      .container {
        padding: 15px;
        max-width: 1200px;
        margin: 0 auto;
      }

      h2,
      h3,
      h4 {
        color: #2c3e50;
        text-align: center;
        margin-bottom: 8px;
      }

      .table-section {
        margin-bottom: 30px;
      }

      .table {
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        margin-bottom: 15px;
      }

      .table-buttons {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-bottom: 20px;
      }

      .table th,
      .table td {
        text-align: center;
        vertical-align: middle;
        padding: 8px;
      }

      .action-buttons {
        display: flex;
        justify-content: center;
        gap: 10px;
      }

      .edit-btn,
      .complete-btn {
        margin: 2px;
        padding: 4px 8px;
        font-size: 12px;
      }

      .completed-task {
        background-color: #d4edda !important;
        text-decoration: line-through;
      }

      @media (max-width: 430px) {
        .table {
          font-size: 12px;
        }
        .edit-btn,
        .complete-btn {
          padding: 2px 4px;
          font-size: 10px;
        }
        .container {
          padding: 10px;
        }
        .action-buttons {
          flex-direction: column;
          gap: 5px; /* تقليل المسافة بين الأزرار في الشاشات الصغيرة */
        }
      }

      @media print {
        .edit-btn,
        .complete-btn,
        .print-btn,
        .navigation-buttons {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- العناوين -->
      <div class="text-center mt-3">
        <h2 class="fs-5 editable" id="title1">السرية الأولى</h2>
        <button
          class="btn btn-warning btn-sm edit-btn"
          onclick="editText('title1')"
        >
          تعديل
        </button>

        <h3 class="fs-6 editable" id="title2">فصيل (1)</h3>
        <button
          class="btn btn-warning btn-sm edit-btn"
          onclick="editText('title2')"
        >
          تعديل
        </button>

        <h3 class="fs-6 editable" id="title3">مجموعة (7)</h3>
        <button
          class="btn btn-warning btn-sm edit-btn"
          onclick="editText('title3')"
        >
          تعديل
        </button>

        <h4 class="header fs-6 editable" id="title4">
          بيان بالمهام المكلفة بها قوة المهام والواجبات الخاصة
        </h4>
        <button
          class="btn btn-warning btn-sm edit-btn"
          onclick="editText('title4')"
        >
          تعديل
        </button>
      </div>

      <!-- الجدول الأول -->
      <div class="table-responsive mt-4">
        <div class="table-section">
          <h3 class="fs-6 mb-3">الجدول الأول</h3>
          <table
            class="table table-bordered table-striped text-center align-middle"
            id="mainTable1"
          >
            <thead class="table-dark">
              <tr>
                <th>اليوم والتاريخ</th>
                <th>الاستعداد والبداية</th>
                <th>نوع المهمة</th>
                <th>الموقع</th>
                <th>المطلوب</th>
                <th>تعديل</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>الثلاثاء 1446/8/5</td>
                <td>المباشرة بالموقع<br />الساعة 8:00 ص</td>
                <td>الاتصال حسب التوجيه</td>
                <td>-</td>
                <td>-</td>
                <td class="button-cell">
                  <div class="action-buttons">
                    <button
                      class="btn btn-warning btn-sm edit-btn"
                      onclick="editRow(this, 'mainTable1')"
                    >
                      تعديل
                    </button>
                    <button
                      class="btn btn-success btn-sm complete-btn"
                      onclick="completeTask(this, 'mainTable1')"
                    >
                      اكتمال
                    </button>
                  </div>
                </td>
              </tr>
              <tr>
                <td>الثلاثاء 1446/8/5</td>
                <td>من الساعة 3:30 م إلى الساعة 12:00 ص</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td class="button-cell">
                  <div class="action-buttons">
                    <button
                      class="btn btn-warning btn-sm edit-btn"
                      onclick="editRow(this, 'mainTable1')"
                    >
                      تعديل
                    </button>
                    <button
                      class="btn btn-success btn-sm complete-btn"
                      onclick="completeTask(this, 'mainTable1')"
                    >
                      اكتمال
                    </button>
                  </div>
                </td>
              </tr>
              <tr>
                <td>الثلاثاء 1446/8/5</td>
                <td>
                  المباشرة بالموقع الساعة 1:30 م<br />
                  بداية المباراة الساعة 3:55 م
                </td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td class="button-cell">
                  <div class="action-buttons">
                    <button
                      class="btn btn-warning btn-sm edit-btn"
                      onclick="editRow(this, 'mainTable1')"
                    >
                      تعديل
                    </button>
                    <button
                      class="btn btn-success btn-sm complete-btn"
                      onclick="completeTask(this, 'mainTable1')"
                    >
                      اكتمال
                    </button>
                  </div>
                </td>
              </tr>
              <tr>
                <td>الثلاثاء 1446/8/5</td>
                <td>
                  المباشرة بالموقع الساعة 2:00 م<br />
                  بداية المباراة الساعة 3:00 م
                </td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td class="button-cell">
                  <div class="action-buttons">
                    <button
                      class="btn btn-warning btn-sm edit-btn"
                      onclick="editRow(this, 'mainTable1')"
                    >
                      تعديل
                    </button>
                    <button
                      class="btn btn-success btn-sm complete-btn"
                      onclick="completeTask(this, 'mainTable1')"
                    >
                      اكتمال
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>

          <div class="table-buttons mt-3">
            <button
              class="btn btn-success btn-sm"
              onclick="addNewRow('mainTable1')"
            >
              إضافة صف للجدول الأول
            </button>
            <button
              class="btn btn-primary btn-sm print-btn"
              onclick="printTable('mainTable1')"
            >
              طباعة الجدول الأول
            </button>
          </div>
        </div>
      </div>

      <!-- الجدول الثاني -->
      <div class="table-responsive mt-5">
        <h3 class="fs-6 mb-3">الجدول الثاني</h3>
        <table
          class="table table-bordered table-striped text-center align-middle"
          id="mainTable2"
        >
          <thead class="table-dark">
            <tr>
              <th>اليوم والتاريخ</th>
              <th>الاستعداد والبداية</th>
              <th>نوع المهمة</th>
              <th>الموقع</th>
              <th>المطلوب</th>
              <th>تعديل</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>-</td>
              <td>من الساعة 6:00 ص إلى 2:00 ص</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td class="button-cell">
                <div class="action-buttons">
                  <button
                    class="btn btn-warning btn-sm edit-btn"
                    onclick="editRow(this, 'mainTable2')"
                  >
                    تعديل
                  </button>
                  <button
                    class="btn btn-success btn-sm complete-btn"
                    onclick="completeTask(this, 'mainTable2')"
                  >
                    اكتمال
                  </button>
                </div>
              </td>
            </tr>
            <tr>
              <td>-</td>
              <td>24 ساعة باستمرار</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td class="button-cell">
                <div class="action-buttons">
                  <button
                    class="btn btn-warning btn-sm edit-btn"
                    onclick="editRow(this, 'mainTable2')"
                  >
                    تعديل
                  </button>
                  <button
                    class="btn btn-success btn-sm complete-btn"
                    onclick="completeTask(this, 'mainTable2')"
                  >
                    اكتمال
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <div class="table-buttons mt-3">
          <button
            class="btn btn-success btn-sm"
            onclick="addNewRow('mainTable2')"
          >
            إضافة صف للجدول الثاني
          </button>
          <button
            class="btn btn-primary btn-sm print-btn"
            onclick="printTable('mainTable2')"
          >
            طباعة الجدول الثاني
          </button>
        </div>
      </div>

      <!-- المقدمة -->
      <div class="introduction mt-5">
        <p class="fs-6 text-end">
          السلام عليكم ورحمة الله وبركاته تجولون أعلاه بيان بالمهام الأسبوعية
          المراد تغطيتها أمنياً من قبلكم، بالإضافة للمهام الطارئة لذا عليكم
          متابعة تغطيتها بالوقت المحدد دون أي ملاحظات مع التنبيه على العموم
          بارتداء السلاح والتجهيزات الميدانية اللازمة لكل مهمة كالخدمة والتنسيق
          معنا بما يستجد أول بأول،،، والسلام
        </p>
        <p class="fs-6 text-end">ص/ ضباط خفر رقباء السرايا ص/ العمليات</p>
      </div>

      <!-- الملاحظات -->
      <div class="notes mt-5">
        <h5 class="fs-6 editable" id="notesTitle">
          ملاحظات هامة وتعليمات يجب الالتزام بها:
        </h5>
        <button
          class="btn btn-warning btn-sm edit-btn"
          onclick="editText('notesTitle')"
        >
          تعديل
        </button>
        <ul class="fs-6">
          <li>
            التواجد في المواقع المحددة لكل مهمة قبل الموعد المحدد بـ 30 دقيقة
            على الأقل.
          </li>
          <li>التأكد من جاهزية الأفراد والمعدات قبل بدء المهمة.</li>
          <li>الالتزام بالزي العسكري الموحد والمظهر العام.</li>
          <li>التواصل المستمر مع قائد المجموعة لتلقي التوجيهات.</li>
          <li>
            الإبلاغ الفوري عن أي مستجدات أو مشكلات تواجه الأفراد أثناء تنفيذ
            المهمة.
          </li>
        </ul>
        <p class="fs-6 text-center editable" id="signatureTitle">
          قائد قوة المهام والواجبات الخاصة
        </p>
        <button
          class="btn btn-warning btn-sm edit-btn"
          onclick="editText('signatureTitle')"
        >
          تعديل
        </button>
        <p class="fs-6 text-center editable" id="signatureName">
          عقيد / فيصل بن خالد النفيسه
        </p>
        <button
          class="btn btn-warning btn-sm edit-btn"
          onclick="editText('signatureName')"
        >
          تعديل
        </button>
      </div>

      <!-- أزرار التنقل -->
      <div class="text-center mt-4 navigation-buttons">
        <a href="second.html" class="btn btn-secondary btn-sm">الجدول الثالث</a>
        <a href="pending_tasks.html" class="btn btn-warning btn-sm"
          >المهام المؤجلة</a
        >
        <a href="statistics.html" class="btn btn-secondary btn-sm">الإحصائية</a>
      </div>
    </div>

    <!-- مكتبات جافاسكربت -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- السكربتات الخاصة -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        loadTableData("mainTable1");
        loadTableData("mainTable2");
      });

      function addNewRow(tableId) {
        const table = document
          .getElementById(tableId)
          .getElementsByTagName("tbody")[0];
        const newRow = table.insertRow();
        newRow.innerHTML = `
          <td contenteditable="true">-</td>
          <td contenteditable="true">-</td>
          <td contenteditable="true">-</td>
          <td contenteditable="true">-</td>
          <td contenteditable="true">-</td>
          <td class="button-cell">
            <div class="action-buttons">
              <button class="btn btn-warning btn-sm edit-btn" onclick="editRow(this, '${tableId}')">تعديل</button>
              <button class="btn btn-success btn-sm complete-btn" onclick="completeTask(this, '${tableId}')">اكتمال</button>
            </div>
          </td>
        `;
        saveTableData(tableId);
      }

      function editRow(button, tableId) {
        const row = button.closest("tr");
        row
          .querySelectorAll("td:not(.button-cell)")
          .forEach((td) => (td.contentEditable = "true"));
        const editButton = row.querySelector(".edit-btn");
        editButton.innerText = "حفظ";
        editButton.className = "btn btn-success btn-sm edit-btn";
        editButton.onclick = function () {
          saveRow(this, tableId);
        };
      }

      function saveRow(button, tableId) {
        const row = button.closest("tr");
        row
          .querySelectorAll("td:not(.button-cell)")
          .forEach((td) => (td.contentEditable = "false"));
        const editButton = row.querySelector(".edit-btn");
        editButton.innerText = "تعديل";
        editButton.className = "btn btn-warning btn-sm edit-btn";
        editButton.onclick = function () {
          editRow(this, tableId);
        };
        saveTableData(tableId);
      }

      function completeTask(button, tableId) {
        const row = button.closest("tr");
        row.classList.toggle("completed-task");
        const completeButton = row.querySelector(".complete-btn");
        completeButton.innerText = row.classList.contains("completed-task")
          ? "تراجع"
          : "اكتمال";
        completeButton.classList.toggle("btn-secondary");
        completeButton.classList.toggle("btn-success");
        saveTableData(tableId);
      }

      function saveTableData(tableId) {
        const table = document
          .getElementById(tableId)
          .getElementsByTagName("tbody")[0];
        const rows = table.getElementsByTagName("tr");
        const data = [];
        for (let row of rows) {
          const cells = row.getElementsByTagName("td");
          data.push([
            cells[0].innerText,
            cells[1].innerText,
            cells[2].innerText,
            cells[3].innerText,
            cells[4].innerText,
            row.classList.contains("completed-task"),
          ]);
        }
        localStorage.setItem(tableId + "_tasks", JSON.stringify(data));
      }

      function loadTableData(tableId) {
        const table = document
          .getElementById(tableId)
          .getElementsByTagName("tbody")[0];
        const savedData = localStorage.getItem(tableId + "_tasks");
        if (savedData) {
          table.innerHTML = "";
          JSON.parse(savedData).forEach((rowData) => {
            const row = table.insertRow();
            row.innerHTML = `
              <td contenteditable="false">${rowData[0]}</td>
              <td contenteditable="false">${rowData[1]}</td>
              <td contenteditable="false">${rowData[2]}</td>
              <td contenteditable="false">${rowData[3]}</td>
              <td contenteditable="false">${rowData[4]}</td>
              <td class="button-cell">
                <div class="action-buttons">
                  <button class="btn btn-warning btn-sm edit-btn" onclick="editRow(this, '${tableId}')">تعديل</button>
                  <button class="btn btn-success btn-sm complete-btn" onclick="completeTask(this, '${tableId}')">اكتمال</button>
                </div>
              </td>
            `;
            if (rowData[5]) row.classList.add("completed-task");
          });
        }
      }

      function printTable(tableId) {
        const buttons = document.querySelectorAll(".btn");
        buttons.forEach((btn) => (btn.style.display = "none"));
        window.print();
        buttons.forEach((btn) => (btn.style.display = "inline-block"));
      }

      function editText(elementId) {
        const element = document.getElementById(elementId);
        const currentValue = element.innerHTML;
        element.innerHTML = `<input type="text" class="form-control form-control-sm" value="${currentValue}">`;
        const button = element.nextElementSibling;
        button.innerText = "حفظ";
        button.className = "btn btn-success btn-sm";
        button.onclick = function () {
          saveText(elementId);
        };
      }

      function saveText(elementId) {
        const element = document.getElementById(elementId);
        const input = element.getElementsByTagName("input")[0];
        element.innerHTML = input.value;
        const button = element.nextElementSibling;
        button.innerText = "تعديل";
        button.className = "btn btn-warning btn-sm";
        button.onclick = function () {
          editText(elementId);
        };
        localStorage.setItem(elementId, input.value);
      }

      // تحميل النصوص المحفوظة عند تحميل الصفحة
      window.onload = function () {
        [
          "title1",
          "title2",
          "title3",
          "title4",
          "notesTitle",
          "signatureTitle",
          "signatureName",
        ].forEach((id) => {
          const savedValue = localStorage.getItem(id);
          if (savedValue) {
            document.getElementById(id).innerHTML = savedValue;
          }
        });
      };
    </script>
  </body>
</html>
